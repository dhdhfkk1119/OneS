<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: html}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <th:block th:fragment="css">
        <link rel="stylesheet" th:href="@{/css/mypage.css}">
        <link rel="stylesheet" th:href="@{/css/index.css}">
        <link rel="stylesheet" th:href="@{/css/profile.css}">
    </th:block>
</head>
<body>
<th:block th:fragment="content">
    <div class="admin-container">
        <!-- ÏÉÅÎã® Ï†ïÎ≥¥ -->
        <div class="admin-info">
            <div>Ï†ÑÏ≤¥ ÌöåÏõê Ïàò: <span id="total-users" th:text="${memberList.size()}"></span></div>
            <div>Ï†ÑÏ≤¥ Í≤åÏãúÎ¨º Ïàò: <span id="total-posts" th:text="${boardList.size()}"></span></div>
            <div>ÌòÑÏû¨ Î°úÍ∑∏Ïù∏ Ï§ëÏù∏ ÌöåÏõê Ïàò: <span id="online-users" th:text="${connectMember}"></span></div>
        </div>

        <!-- ÏôºÏ™ΩÍ≥º Ïò§Î•∏Ï™Ω divÎ°ú ÎÇòÎàÑÍ∏∞ -->
        <div class="admin-content">
            <!-- ÏôºÏ™Ω: Ïú†Ï†Ä ÏäπÏù∏ Ï†ïÎ≥¥ -->
            <div class="user-info" id="user-info">
                <div class="unapproved-users">
                    <h3>
                        <span>ÏäπÏù∏ÎêòÏßÄ ÏïäÏùÄ Ïú†Ï†Ä :</span>
                        <span th:text="${InProgress}" class="action-count" id="InProgress"></span>
                    </h3>
                    <div class="In-progress" th:each="member : ${memberList}"
                         th:if="${member.userAction == 'In-progress'}">
                        <div class="user-image">
                            <img th:src="@{${'/profile-images/' + member.userImage}}" alt="" width="50px"
                                 style="border-radius: 50%">
                        </div>
                        <div class="user-info">
                            <div class="user-info-inner">
                                <span class="user-name" th:text="${member.userName}"></span>
                                <span class="user-id" th:text="${'@'+member.userId}"></span>
                            </div>
                            <div class="user-action">
                                <button class="approve-btn" th:data-idx="${member.idx}">ÏäπÏù∏ÌïòÍ∏∞</button>
                                <button class="delete-btn" th:data-idx="${member.idx}">Í≥ÑÏ†ïÏÇ≠Ï†ú ÌïòÍ∏∞</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="approved-users">
                    <h3>
                        <span>ÏäπÏù∏Îêú Ïú†Ï†Ä :</span>
                        <span th:text="${InCompleted}" id="InCompleted" class="action-count"></span>
                    </h3>
                    <!-- ÏäπÏù∏Îêú Ïú†Ï†Ä Î™©Î°ù -->
                    <div class="In-completed" th:each="member : ${memberList}"
                         th:if="${member.userAction == 'In-completed'}">
                        <a th:href="@{${'/profile/' + member.idx}}">
                            <div class="user-image">
                                <img th:src="@{${'/profile-images/' + member.userImage}}" alt="" width="50px"
                                     style="border-radius: 50%">
                            </div>
                        </a>
                        <div class="user-info">
                            <div class="user-info-inner">
                                <span class="user-name" th:text="${member.userName}"></span>
                                <span class="user-id" th:text="${'@'+member.userId}"></span>
                                <a th:href="@{${'/message/' + member.idx}}">
                                    <img src="/local-images/conversation.png" alt="" width="20px">
                                </a>
                            </div>
                            <div class="user-action">
                                <button class="un-approve-btn" disabled>ÏäπÏù∏ÏôÑÎ£å</button>
                                <button class="delete-btn" th:data-idx="${member.idx}">Í≥ÑÏ†ïÏÇ≠Ï†ú ÌïòÍ∏∞</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ïò§Î•∏Ï™Ω: Í≤åÏãúÎ¨º Ï†ïÎ≥¥ -->
            <div class="post-info" id="post-info">
                <h3>Í≤åÏãúÎ¨º Ï†ïÎ≥¥</h3>
                <!-- Í≤åÏãúÎ¨º Î™©Î°ù (Ïä§ÌÅ¨Î°§ Í∞ÄÎä•) -->
                <div class="post-list">
                    <div class="post" th:each="boards : ${boardList}" style="position: relative">
                        <!-- ÏÇ≠Ï†ú Î≤ÑÌäº -->
                        <div class="delete-section">
                            <div class="delete-section-inner" onclick="toggleDeleteForm(this)">
                                <span class="delete-span">...</span>
                            </div>
                        </div>

                        <!-- ÏÇ≠Ï†ú Ìèº (Ï≤òÏùåÏóî Ïà®ÍπÄ) -->
                        <div class="delete-form" th:data-idx="${boards.boardIdx}">
                            <span>Ìï¥Îãπ Í≤åÏãúÎ¨º ÏÇ≠Ï†ú</span>
                        </div>

                        <div class="post-header">
                            <a th:href="@{'/profile/' + ${writers[boards.boardIdx].idx}}">
                                <img class="profile-img"
                                     th:src="@{'/profile-images/' + ${writers[boards.boardIdx].userImage}}"
                                     alt="ÌîÑÎ°úÌïÑ">
                            </a>
                            <div class="board-user-info">
                                <span class="user-name" th:text="${writers[boards.boardIdx].userName}"></span>
                                <span class="user-id" th:text="${'@' +writers[boards.boardIdx].userId}"></span>
                            </div>
                            <span class="time" th:data-time="${boards.boardAt}"></span>
                        </div>

                        <a class="boardDetail" th:href="@{${'/board/' + boards.boardIdx}}">
                            <div class="post-content" th:text="${boards.boardContent}">
                            </div>
                            <div class="board-img-list">
                                <div class="board-img-list-inner">
                                    <button class="board-slide-left">&#10094;</button>
                                    <div class="img-list-inner board-list"
                                         th:each="imgUrl : ${boardImages[boards.boardIdx]}">
                                        <img th:src="@{${'/board-images/' + imgUrl}}" alt="Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ">
                                    </div>
                                    <button class="board-slide-right">&#10095;</button>
                                </div>
                            </div>
                        </a>
                        <div class="post-actions">
                            <span class="toggle-comments">üí¨ <span th:text="${boards.boardComent}"></span></span>
                            <span>
                                <span class="boardLike-btn" th:data-board-idx="${boards.boardIdx}">‚ù§Ô∏è</span>
                                <span class="board-like-count" th:text="${boards.boardLike}"></span>
                            </span>
                            <span>üëÄ <span th:text="${boards.boardView}"></span></span>
                        </div>

                        <!--     ÎåìÍ∏ÄÏ∞Ω ÌåùÏóÖ     -->
                        <div class="comment-section" th:attr="data-board-id=${boards.boardIdx}"
                             style="border-top: none;">
                            <!--  ÎåìÍ∏Ä Î™©Î°ù Í∞ÄÏ†∏Ïò§Í∏∞   -->
                            <div th:each="comment : ${commentList[boards.boardIdx]}" class="comment-bar">
                                <div>
                                    <div class="post-header">
                                        <a th:href="@{${'/profile/' + commentwirtes[comment.commentIdx].idx}}">
                                            <img class="profile-img"
                                                 th:src="@{${'/profile-images/' + commentwirtes[comment.commentIdx].userImage}}"
                                                 alt="ÌîÑÎ°úÌïÑ">
                                        </a>
                                        <div class="user-info">
                                            <span class="user-name"
                                                  th:text="${commentwirtes[comment.commentIdx].userName}"></span>
                                            <span class="user-id"
                                                  th:text="${'@' +commentwirtes[comment.commentIdx].userId}"></span>
                                        </div>
                                    </div>
                                    <div class="comment-main">
                                        <div class="post-content comment-content" th:text="${comment.commentContent}">
                                        </div>
                                        <div class="board-img-list comment-img-list">
                                            <div class="board-img-list-inner comment-img-list-inner">
                                                <button class="board-slide-left">&#10094;</button>
                                                <div class="comment-img-list-inner-container">
                                                    <div class="img-list-inner"
                                                         th:each="imgUrl : ${commentImages.get(comment.commentIdx)}">
                                                        <img th:src="@{${'/comment-images/' + imgUrl}}" alt="Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ">
                                                    </div>
                                                </div>
                                                <button class="board-slide-right">&#10095;</button>
                                            </div>
                                        </div>
                                        <div class="post-actions">
                                            <span class="toggle-comments">üí¨ <span
                                                    th:text="${comment.commentRelay}"></span></span>
                                            <span>
                                <span class="comment-like-btn" th:data-comment-idx="${comment.commentIdx}">‚ù§Ô∏è</span>
                                <span class="comment-like-count" th:text="${comment.commentLike}"></span>
                            </span>
                                            <span>üëÄ <span th:text="${comment.commentView}"></span></span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="board-detail-src">
                                <a th:href="@{${'/board/' + boards.boardIdx}}">ÎåìÍ∏Ä ÎçîÎ≥¥Í∏∞</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</th:block>
</body>
</html>
<script>
    // Ìï¥Îãπ Ïú†Ï†ÄÎ•º ÏäπÏù∏ÌïòÍ∏∞
    document.querySelectorAll(".approve-btn").forEach(btn => {
        btn.addEventListener("click", function () {
            const setIdx = this.dataset.idx;
            const currentBtn = this; // Î≤ÑÌäº Ï∞∏Ï°∞ Ï†ÄÏû•

            const isConfirmed = confirm("Ï†ïÎßê Ïù¥ Ïú†Ï†ÄÎ•º ÏäπÏù∏ÌïòÏãúÍ≤†ÎãàÍπå?");
            if (!isConfirmed) {
                return;
            }

            fetch(`/admin/approveUser`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({userIdx: setIdx}) // userIdx Í∞íÏùÑ Controller Î≥¥ÎÇ¥Ï§å
            })
                .then(response => response.json()) // ÏÑúÎ≤Ñ ÏùëÎãµÏùÑ JSON ÏúºÎ°ú Î∞õÍ∏∞
                .then(data => {
                    console.log("ÏÑúÎ≤Ñ ÏùëÎãµ :", data);
                    // Î≤ÑÌäº ÌÖçÏä§Ìä∏Î•º "ÏäπÏù∏ ÏôÑÎ£å"Î°ú Î≥ÄÍ≤Ω
                    currentBtn.textContent = "ÏäπÏù∏ ÏôÑÎ£å";
                    currentBtn.classList.add("un-approve-btn");
                    // Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî (ÏõêÌïòÎäî Í≤ΩÏö∞)
                    currentBtn.disabled = true;

                    // Ïã§ÏãúÍ∞Ñ ÏäπÏù∏ Ïú†Ï†Ä ÏóÖÎç∞Ïù¥Ìä∏
                    if (data.InProgressCount !== undefined) {
                        document.getElementById('InProgress').textContent = data.InProgressCount;
                    }
                    if (data.InCompletedCount !== undefined) {
                        document.getElementById('InCompleted').textContent = data.InCompletedCount;
                    }
                    // Í∏∞Ï°¥ In-progressÏóêÏÑú ÏÇ≠Ï†ú
                    const memberElement = btn.closest('.In-progress');
                    if (memberElement) {
                        memberElement.remove();
                    }

                    // In-completed ÏòÅÏó≠Ïóê ÏÉàÎ°ú Ï∂îÍ∞Ä
                    const completedContainer = document.querySelector('.In-completed');
                    if (completedContainer) {
                        const newMemberDiv = document.createElement('div');
                        newMemberDiv.className = 'In-completed'; // Ïä§ÌÉÄÏùº ÌÅ¥ÎûòÏä§ Ïù¥Î¶Ñ

                        newMemberDiv.innerHTML = `
                    <div class="In-completed" th:each="member : ${memberList}"
                         th:if="${member.userAction == 'In-completed'}">
                        <a th:href="@{${'/profile/' + member.idx}}">
                            <div class="user-image">
                                <img th:src="@{${'/profile-images/' + member.userImage}}" alt="" width="50px"
                                     style="border-radius: 50%">
                            </div>
                        </a>
                        <div class="user-info">
                            <div class="user-info-inner">
                                <span class="user-name" th:text="${member.userName}"></span>
                                <span class="user-id" th:text="${'@'+member.userId}"></span>
                                <a th:href="@{${'/message/' + member.idx}}">
                                    <img src="/local-images/conversation.png" alt="" width="20px">
                                </a>
                            </div>
                            <div class="user-action">
                                <button class="un-approve-btn" disabled>ÏäπÏù∏ÏôÑÎ£å</button>
                                <button class="delete-btn" th:data-idx="${member.idx}">Í≥ÑÏ†ïÏÇ≠Ï†ú ÌïòÍ∏∞</button>
                            </div>
                        </div>
                    </div>
                `;
                        completedContainer.appendChild(newMemberDiv);
                    }
                });
        });
    });

    // Ìï¥Îãπ Ïú†Ï†ÄÎ•º ÏÇ≠Ï†úÌïòÍ∏∞
    document.querySelectorAll(".delete-btn").forEach(btn => {
        btn.addEventListener("click", function () {
            const setIdx = this.dataset.idx;
            const currentBtn = this; // Î≤ÑÌäº Ï∞∏Ï°∞ Ï†ÄÏû•

            const isConfirmed = confirm("Ï†ïÎßê Ïù¥ Ïú†Ï†ÄÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?");
            if (!isConfirmed) {
                return;
            }

            fetch(`/admin/DeleteUser`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({userIdx: setIdx}) // userIdx Í∞íÏùÑ Controller Î≥¥ÎÇ¥Ï§å
            })
                .then(response => response.json()) // ÏÑúÎ≤Ñ ÏùëÎãµÏùÑ JSON ÏúºÎ°ú Î∞õÍ∏∞
                .then(data => {
                    console.log("ÏÑúÎ≤Ñ ÏùëÎãµ :", data);
                    // Î≤ÑÌäº ÌÖçÏä§Ìä∏Î•º "ÏäπÏù∏ ÏôÑÎ£å"Î°ú Î≥ÄÍ≤Ω
                    currentBtn.textContent = "ÏÇ≠Ï†ú ÏôÑÎ£å";
                    currentBtn.classList.add("un-approve-btn");
                    // Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî (ÏõêÌïòÎäî Í≤ΩÏö∞)
                    currentBtn.disabled = true;

                    // Ïã§ÏãúÍ∞Ñ ÏäπÏù∏ Ïú†Ï†Ä ÏóÖÎç∞Ïù¥Ìä∏
                    if (data.InProgressCount !== undefined) {
                        document.getElementById('InProgress').textContent = data.InProgressCount;
                    }
                    if (data.InCompletedCount !== undefined) {
                        document.getElementById('InCompleted').textContent = data.InCompletedCount;
                    }

                    // ÏÇ≠Ï†úÎêú Ïú†Ï†Ä DOM ÏöîÏÜå ÏÇ≠Ï†ú
                    let userElement = currentBtn.closest('.In-progress'); // Î®ºÏ†Ä In-progressÏóêÏÑú Ï∞æÏïÑÎ≥¥Í≥†
                    if (!userElement) {
                        userElement = currentBtn.closest('.In-completed'); // ÏóÜÏúºÎ©¥ In-completedÏóêÏÑú Ï∞æÏïÑ
                    }
                    if (userElement) {
                        userElement.remove(); // ÏµúÏ¢ÖÏ†ÅÏúºÎ°ú Ìï¥Îãπ div ÏÇ≠Ï†ú
                    }
                });
        });
    });


    // Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥ Î≤ÑÌäº ÌÅ¥Î¶≠Ïãú a ÌÉúÍ∑∏Î°ú Í∞ÄÎäî Ïù¥Îèô ÎßâÍ∏∞
    document.querySelectorAll('.board-slide-left, .board-slide-right')
        .forEach(btn => {
            btn.addEventListener('click', function (event) {
                event.preventDefault();      // a ÌÉúÍ∑∏ Ïù¥Îèô ÎßâÍ∏∞
                event.stopPropagation();    // Î∂ÄÎ™® ÏöîÏÜåÎ°ú Ïù¥Î≤§Ìä∏ Ï†ÑÌååÎèÑ ÎßâÍ∏∞

                // Ïä¨ÎùºÏù¥Îìú Î°úÏßÅ Ïã§Ìñâ
                console.log("Ïä¨ÎùºÏù¥Îìú Î≤ÑÌäº ÌÅ¥Î¶≠!");
            });
        });

    // ÎåìÍ∏Ä Ï∞Ω Ïó¥Í∏∞ ÌÜ†Í∏Ä
    document.addEventListener("DOMContentLoaded", function () {
        const commentToggles = document.querySelectorAll(".toggle-comments");
        commentToggles.forEach(toggle => {
            toggle.addEventListener("click", function () {
                const commentSection = this.closest(".post").querySelector(".comment-section");
                if (commentSection.style.display === "none" || commentSection.style.display === "") {
                    commentSection.style.display = "block";
                } else {
                    commentSection.style.display = "none";
                }
            });
        });
    });

    // ÌòÑÏû¨ ÏãúÍ∞ÑÏóêÏÑú - Í≤åÏã§Î¨º Ïò¨Î¶∞ ÏãúÍ∞Ñ ÎÇòÌÉÄÎÇ¥Í∏∞
    document.addEventListener("DOMContentLoaded", function () {
        const timeElements = document.querySelectorAll(".time");

        timeElements.forEach(element => {
            const boardTime = new Date(element.getAttribute("data-time")); // Í≤åÏãúÎ¨º ÏãúÍ∞Ñ
            const now = new Date(); // ÌòÑÏû¨ ÏãúÍ∞Ñ

            const diff = Math.floor((now - boardTime) / 1000); // Ï¥à Îã®ÏúÑ Ï∞®Ïù¥

            let timeAgo;
            if (diff < 60) {
                timeAgo = "Î∞©Í∏à Ï†Ñ";
            } else if (diff < 3600) {
                timeAgo = Math.floor(diff / 60) + "Î∂Ñ Ï†Ñ";
            } else if (diff < 86400) {
                timeAgo = Math.floor(diff / 3600) + "ÏãúÍ∞Ñ Ï†Ñ";
            } else if (diff < 604800) {
                timeAgo = Math.floor(diff / 86400) + "Ïùº Ï†Ñ";
            } else {
                timeAgo = boardTime.toISOString().split("T")[0]; // 1Ï£º Ïù¥ÏÉÅÏù¥Î©¥ ÎÇ†Ïßú ÌëúÏãú
            }

            element.textContent = timeAgo;
        });
    });

    // Í≤åÏã§Î¨º Ïù¥ÎØ∏ÏßÄ Î≤ÑÌäº
    function ImgUpload(event) {
        event.preventDefault(); // Í∏∞Î≥∏ Ïù¥Î≤§Ìä∏(Ìèº Ï†úÏ∂ú) Î∞©ÏßÄ
        document.querySelector(".upload-btn").click();
    }

    // ÎåìÍ∏Ä Ïù¥ÎØ∏ÏßÄ Î≤ÑÌäº
    function CommentImgUpload(event) {
        event.preventDefault();

        const button = event.currentTarget; // Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉù Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠
        const boardId = button.dataset.boardId; // ÌÅ¥Î¶≠Ìïú Î≤ÑÌäºÏùò data Í∞íÏùÑ Í∞ÄÏ†∏Ïò¥

        // Îçî ÏïàÏ†ÑÌïòÍ≤å: Î≤ÑÌäº Í∏∞Ï§ÄÏúºÎ°ú Í∞ÄÏû• Í∞ÄÍπåÏö¥ comment-section Ï∞æÍ∏∞
        const commentSection = button.closest(".comment-section");// Î≤ÑÌäº Í∏∞Ï§ÄÏúºÎ°ú Í∞ÄÏû• Í∞ÄÍπåÏö¥ .comment-section Ï∞æÍ∏∞

        const fileInput = commentSection.querySelector(".commentupload-btn"); // Ìï¥Îãπ ÏÑπÏÖò ÏïàÏùò input[type="file"] Ï∞æÍ∏∞

        fileInput.dataset.boardId = boardId; // fileInputÏóê data Í∞íÏùÑ Í∞ïÏ†úÎ°ú ÎÑ£Ïñ¥Ï§å
        fileInput.click(); // input ÌÅ¥Î¶≠Ìï¥ÏÑú ÌååÏùº ÏÑ†ÌÉùÏ∞Ω Ïó¥Í∏∞
    }

    // Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îìú
    document.addEventListener("DOMContentLoaded", function () {
        const sliders = document.querySelectorAll(".board-img-list-inner");

        sliders.forEach(slider => {
            const imgContainer = slider.querySelectorAll(".board-list");
            const images = Array.from(imgContainer);
            const leftBtn = slider.querySelector(".board-slide-left");
            const rightBtn = slider.querySelector(".board-slide-right");
            let currentIndex = 0;
            const imgWidth = 285; // Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞ (275px + Ïó¨Î∞± 25px Í≥†Î†§)
            const maxIndex = images.length - 2; // ‚úÖ ÏµúÎåÄ Ïù¥Îèô Í∞ÄÎä• Ïù∏Îç±Ïä§

            // Ïä¨ÎùºÏù¥Îìú Ïù¥Îèô Ìï®Ïàò
            function updateSlide() {
                const offset = -(currentIndex * imgWidth);
                imgContainer.forEach(img => img.style.transform = `translateX(${offset}px)`);

                // ÏôºÏ™Ω Î≤ÑÌäº Ï†úÏñ¥
                leftBtn.style.display = currentIndex > 0 ? 'block' : 'none';

                // Ïò§Î•∏Ï™Ω Î≤ÑÌäº Ï†úÏñ¥
                rightBtn.style.display = currentIndex >= maxIndex ? 'none' : 'block';
            }

            // ‚¨ÖÔ∏è ÏôºÏ™Ω Ïù¥Îèô
            leftBtn.addEventListener("click", function () {
                if (currentIndex > 0) {
                    currentIndex--;
                    updateSlide();
                }
            });

            // ‚û°Ô∏è Ïò§Î•∏Ï™Ω Ïù¥Îèô
            rightBtn.addEventListener("click", function () {
                if (currentIndex < maxIndex) {
                    currentIndex++;
                    updateSlide();
                }
            });

            // Ï¥àÍ∏∞ Ïä¨ÎùºÏù¥Îìú ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            updateSlide();
        });
    });

    // ÎåìÍ∏Ä Î¶¨Ïä§Ìä∏ Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îìú
    document.addEventListener("DOMContentLoaded", function () {
        const sliders = document.querySelectorAll(".comment-img-list-inner");

        sliders.forEach(slider => {
            const imgContainer = slider.querySelector(".comment-img-list-inner-container");
            const images = slider.querySelectorAll(".img-list-inner");
            const leftBtn = slider.querySelector(".board-slide-left");
            const rightBtn = slider.querySelector(".board-slide-right");

            if (!imgContainer || images.length === 0) return;

            const imageWidth = 285; // Ïù¥ÎØ∏ÏßÄ 275 + ÎßàÏßÑ Ìè¨Ìï®
            const moveStep = 275;   // Ïä¨ÎùºÏù¥Îìú Ïù¥Îèô Ìè≠
            const viewWidth = 456;  // Î≥¥Ïó¨ÏßÄÎäî ÏòÅÏó≠ Ìè≠

            const totalWidth = images.length * imageWidth;
            const maxTranslateX = totalWidth - viewWidth;

            const translatePositions = [];
            let currentX = 0;

            while (currentX + viewWidth < totalWidth) {
                translatePositions.push(currentX);
                currentX += moveStep;
            }

            // ÎßàÏßÄÎßâ ÏúÑÏπò Ï∂îÍ∞Ä (ÎÅùÍπåÏßÄ Î≥¥Ïù¥Í≤å)
            if (translatePositions[translatePositions.length - 1] !== maxTranslateX) {
                translatePositions.push(maxTranslateX);
            }

            let currentIndex = 0;


            function updateSlide() {
                if (images.length > 1) {
                    const offset = -translatePositions[currentIndex];
                    imgContainer.style.transform = `translateX(${offset}px)`;
                } else {
                    imgContainer.style.transform = `translateX(0px)`;
                }
                leftBtn.style.display = currentIndex > 0 ? 'block' : 'none';
                rightBtn.style.display = currentIndex < translatePositions.length - 1 ? 'block' : 'none';
            }

            rightBtn.addEventListener("click", () => {
                if (currentIndex < translatePositions.length - 1) {
                    currentIndex++;
                    updateSlide();
                }
            });

            leftBtn.addEventListener("click", () => {
                if (currentIndex > 0) {
                    currentIndex--;
                    updateSlide();
                }
            });

            updateSlide();
        });
    });


    // Í≤åÏãúÍ∏Ä ÏÇ≠Ï†ú ÌÜ†Í∏Ä
    function toggleDeleteForm(btn) {
        const post = btn.closest('.post');
        const deleteForm = post.querySelector('.delete-form');
        deleteForm.classList.toggle('show');
    }

    document.querySelectorAll('.delete-form').forEach(btn => {
        btn.addEventListener("click", function () {
            const idx = btn.dataset.idx;

            const isConfirmed = confirm("Ï†ïÎßê Ïù¥ Ïú†Ï†ÄÏùò Í≤åÏãúÎ¨ºÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?");
            if (!isConfirmed) {
                return;
            }

            fetch(`/board/Delete`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({boardIdx: idx}) // useridx Í∞íÏúºÎ°ú JSONÏùÑ Î≥¥ÎÇ∏Îã§
            })
                .then(response => response.json()) // ÏÑúÎ≤Ñ ÏùëÎãµÏùÑ JSONÏúºÎ°ú Î∞õÍ∏∞
                .then(data => {
                    console.log("ÏÑúÎ≤Ñ ÏùëÎãµ :", data);
                    if (data.BoardCount !== undefined) {
                        document.getElementById("total-posts").textContent = data.BoardCount;
                    }

                    // ÏÇ≠Ï†úÎêú Í≤åÏãúÍ∏ÄÏùÑ ÌôîÎ©¥ÏóêÏÑúÎèÑ ÏßÄÏö¥Îã§
                    const postElement = btn.closest('.post');
                    if (postElement) {
                        postElement.remove();  // DOMÏóêÏÑú ÏÇ≠Ï†ú
                    }
                });
        });
    });
</script>