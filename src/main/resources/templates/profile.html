<!DOCTYPE html>
<html lang="kr" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: html}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <th:block th:fragment="css">
        <link rel="stylesheet" th:href="@{/css/index.css}">
        <link rel="stylesheet" th:href="@{/css/profile.css}">
    </th:block>
</head>
<body>
<th:block th:fragment="content">
    <div class="navbar-detail">
        <div class="navbar-inner-detail">
            <a href="javascript:history.back()">
                <img src="/local-images/back.png" alt="" width="20px">
                <span th:if="${loginMember == null or loginMember.idx != member.idx}">
                    <span class="user-name" th:text="${member.userName + 'ÎãòÏùò'}"></span>
                </span>
                <span sec:authorize="isAuthenticated()" th:if="${loginMember.idx == member.idx}">ÎÇòÏùò Í≤åÏãúÎ¨º</span>
            </a>
        </div>
    </div>

    <!-- ÌòÑÏû¨ ÏûëÏÑ±Ìïú Í≤åÏãúÎ¨ºÏùò Ïú†Ï†ÄÏùò Ï†ïÎ≥¥ -->
    <div class="post-create my-profile">
        <div class="profile-header">
            <!-- ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ -->
            <div class="profile-image">
                <img th:src="@{${'/profile-images/' + member.userImage}}" alt="ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ">
            </div>

            <!-- ÏàòÏ†ï Î≤ÑÌäº -->
            <div class="edit-profile">
                <div class="edit-nosession">
                    <a th:href="@{${'/message/' + member.idx}}" class="edit-message" onclick="message(event)" th:if="${loginMember == null or loginMember.idx != member.idx}"
                       th:data-idx="${member.idx}">
                        <img th:src="@{'/local-images/conversation.png'}" alt="" width="24px">
                    </a>
                    <a th:href="@{${'/message/' + loginMember.idx}}" class="edit-message" onclick="message(event)" th:if="${loginMember == null or loginMember.idx == member.idx}"
                       th:data-idx="${loginMember.idx}">
                        <img th:src="@{'/local-images/conversation.png'}" alt="" width="24px">
                    </a>
                    <button class="follow-btn" th:if="${loginMember == null or loginMember.idx != member.idx}"
                            th:data-member-idx="${member.idx}">
                        ÌåîÎ°úÏö∞ ÌïòÍ∏∞
                    </button>
                </div>
                <button class="edit-btn" sec:authorize="isAuthenticated()" th:if="${loginMember.idx == member.idx}">ÌîÑÎ°úÌïÑ
                    ÏàòÏ†ï
                </button>
            </div>

            <!-- Ïò§Î•∏Ï™Ω Ï†ïÎ≥¥ -->
            <div class="profile-info">
                <div class="info-top">
                    <h2 class="username" th:text="${member.userName}"></h2>
                </div>
                <div>
                    <span class="userid" th:text="${'@' +member.userId}"></span>
                </div>
                <div class="introduce">
                    <span th:text="${member.introduce}"></span>
                </div>
                <div class="profile-info-two">
                    <div class="profile-info-inner">
                        <img th:src="@{'/local-images/calendar.png'}" alt="" width="20px" style="">
                        <span class="joindate">Í∞ÄÏûÖÏùº : </span>
                        <span class="joindate" th:text="${#temporals.format(member.userAt, 'yyyyÎÖÑ MMÏõî')}"></span>
                    </div>
                </div>
                <div class="follow-inner">
                    <div>
                        <span>
                            <a th:href="@{${'/follower/' + member.idx}}">
                                <span class="follow-count follower-count" th:text="${member.follow}">0</span>
                                <span class="follow">ÌåîÎ°úÏõå</span>
                            </a>
                        </span>
                        <span class="following">
                            <a th:href="@{${'/follower/' + member.idx}}">
                                <span class="follow-count following-count" th:text="${member.following}">0</span>
                                <span class="follow">ÌåîÎ°úÏûâ</span>
                            </a>
                        </span>
                    </div>
                    <a href="/boardWrite" sec:authorize="isAuthenticated()">
                        <button  th:if="${loginMember.idx == member.idx}" class="write-btn">Í≤åÏãúÎ¨º ÏûëÏÑ±</button>
                    </a>
                </div>
            </div>
        </div>

        <!-- ÌÉ≠ Î©îÎâ¥ -->
        <div class="profile-tabs">
            <button class="tab-btn active" data-tab="posts">Í≤åÏãúÎ¨º</button>
            <button class="tab-btn" data-tab="comments">ÎåìÍ∏Ä</button>
            <button class="tab-btn" data-tab="likes">Ï¢ãÏïÑÏöî</button>
        </div>
    </div>


    <!-- ÌîÑÎ°úÌïÑ ÏàòÏ†ï ÌåùÏóÖ -->
    <div id="editProfileModal" class="modal">
        <div class="modal-content">
            <!-- Îã´Í∏∞ Î≤ÑÌäº -->
            <span class="close">&times;</span>

            <!-- Ïù¥ÎØ∏ÏßÄ Î≥ÄÍ≤Ω -->
            <div class="modal-profile-image">
                <label for="profileImageInput">
                    <img id="previewImage" th:src="@{${'/profile-images/' + member.userImage}}" alt="ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ">
                    <div class="hover-text">Ïù¥ÎØ∏ÏßÄ Î≥ÄÍ≤Ω</div>
                </label>
                <input type="file" id="profileImageInput" style="display: none;" accept="image/*">
            </div>

            <!-- Ïù¥Î¶Ñ Î≥ÄÍ≤Ω -->
            <div class="modal-name-input">
                <label for="userName">
                    <span>Ïù¥Î¶Ñ</span>
                </label>
                <input type="text" id="userName" th:value="${member.userName}">
            </div>
            <div class="modal-name-input">
                <label for="introduce">
                    <span>ÏûêÍ∏∞ ÏÜåÍ∞ú</span>
                </label>
                <textarea type="text" maxlength="160" id="introduce" th:text="${member.introduce}"
                          th:value="${member.introduce}"
                          placeholder="ÏûêÍ∏∞ÏÜåÍ∞úÎ•º Ï†ÅÏñ¥Ï£ºÏÑ∏Ïöî / 160Ïûê"></textarea>
            </div>


            <!-- Ï†ÄÏû• Î≤ÑÌäº -->
            <button class="save-btn" onclick="SaveBtn()">Ï†ÄÏû•ÌïòÍ∏∞</button>
        </div>
    </div>

    <!-- Í≤åÏãúÍ∏Ä Î™©Î°ù Î¶¨Ïä§Ìä∏ -->
    <div class="tab-content" id="posts">
        <div class="post" th:each="boards : ${boardList}" style="position: relative">
            <!-- ÏÇ≠Ï†ú Î≤ÑÌäº -->
            <div class="delete-section">
                <div class="delete-section-inner" onclick="toggleDeleteForm(this)">
                    <span class="delete-span">...</span>
                </div>
            </div>

            <!-- ÏÇ≠Ï†ú Ìèº (Ï≤òÏùåÏóî Ïà®ÍπÄ) -->
            <div class="delete-form">
                <span>Ìï¥Îãπ Í≤åÏãúÎ¨º ÏÇ≠Ï†ú</span>
            </div>
            <div class="post-header">
                <img class="profile-img" th:src="@{${'/profile-images/' + member.userImage}}" alt="ÌîÑÎ°úÌïÑ">
                <div class="user-info">
                    <span class="user-name" th:text="${member.userName}"></span>
                    <span class="user-id" th:text="${'@' +member.userId}"></span>
                </div>
                <span class="time" th:data-time="${boards.boardAt}"></span>
            </div>
            <a class="boardDetail" th:href="@{${'/board/' + boards.boardIdx}}">
                <div class="post-content" th:text="${boards.boardContent}">
                </div>
                <div class="board-img-list">
                    <div class="board-img-list-inner">
                        <button class="board-slide-left">&#10094;</button>
                        <div class="img-list-inner board-list" th:each="imgUrl : ${boardImages.get(boards.boardIdx)}">
                            <img th:src="@{${'/board-images/' + imgUrl}}" alt="Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ">
                        </div>
                        <button class="board-slide-right">&#10095;</button>
                    </div>
                </div>
            </a>
            <div class="profile-actions">
                <span class="toggle-comments">üí¨ <span th:text="${boards.boardComent}"></span></span>
                <span>
                    <span class="boardLike-btn" th:data-board-idx="${boards.boardIdx}">‚ù§Ô∏è</span>
                    <span class="board-like-count" th:text="${boards.boardLike}"></span>
                </span>
                <span>üëÄ <span th:text="${boards.boardView}"></span></span>
            </div>
            <!--   ÎåìÍ∏Ä Ï∞Ω ÌåùÏóÖ   -->
            <div class="comment-section" th:attr="data-board-id=${boards.boardIdx}">
                <div class="comment-input" th:if="${#authorization.expression('isAuthenticated()')}">
                    <img class="profile-img" th:src="@{${'/profile-images/' + member.userImage}}" alt="ÌîÑÎ°úÌïÑ">
                    <div class="user-info">
                        <span class="user-name" th:text="${member.userName}"></span>
                        <span class="user-id" th:text="${'@' +member.userId}"></span>
                    </div>
                </div>
                <form th:action="@{/comment}" method="post" th:object="${comment}" enctype="multipart/form-data">
                    <input type="hidden" name="from" value="index">
                    <div class="comment-font">
                        <input type="text" th:field="*{commentContent}" placeholder="Î¨¥ÏóáÏùÑ ÏûëÏÑ±ÌïòÏãúÍ≤†ÏäµÎãàÍπå?">
                    </div>

                    <!-- Ïù¥ÎØ∏ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ Ïä¨ÎùºÏù¥Îìú -->
                    <div class="image-slider comment-slider">
                        <button type="button" class="slide-btn left comment-left">&#10094;</button>
                        <div class="preview-container comment-container" id="coment-container"></div>
                        <button type="button" class="slide-btn right comment-right">&#10095;</button>
                    </div>

                    <div class="comment-btn">
                        <input type="hidden" name="boardidx" th:value="${boards.boardIdx}">
                        <input type="file" class="upload-btn commentupload-btn" name="commentfiles"
                               onchange="preView(this);" multiple accept="image/*"/>
                        <button class="file-btn" th:attr="data-board-id=${boards.boardIdx}"
                                onclick="CommentImgUpload(event)">Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉù
                        </button>
                        <button class="comment-submit">ÏûëÏÑ±</button>
                    </div>
                </form>
                <!--  ÎåìÍ∏Ä Î™©Î°ù Í∞ÄÏ†∏Ïò§Í∏∞   -->
                <div th:each="comment : ${commentList[boards.boardIdx]}" class="comment-bar">
                    <div>
                        <div class="post-header">
                            <img class="profile-img"
                                 th:src="@{${'/profile-images/' + commentMember[comment.commentIdx].userImage}}"
                                 alt="ÌîÑÎ°úÌïÑ">
                            <div class="user-info">
                                <span class="user-name" th:text="${commentMember[comment.commentIdx].userName}"></span>
                                <span class="user-id" th:text="${'@' +commentMember[comment.commentIdx].userId}"></span>
                            </div>
                        </div>
                        <div class="comment-main">
                            <div class="post-content comment-content" th:text="${comment.commentContent}">
                            </div>
                            <div class="board-img-list comment-img-list">
                                <div class="board-img-list-inner comment-img-list-inner">
                                    <button class="board-slide-left">&#10094;</button>
                                    <div class="comment-img-list-inner-container">
                                        <div class="img-list-inner"
                                             th:each="imgUrl : ${commentImages.get(comment.commentIdx)}">
                                            <img th:src="@{${'/comment-images/' + imgUrl}}" alt="Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ">
                                        </div>
                                    </div>
                                    <button class="board-slide-right">&#10095;</button>
                                </div>
                            </div>
                            <div class="profile-actions">
                                <span class="toggle-comments">üí¨ <span th:text="${comment.commentRelay}"></span></span>
                                <span>
                                    <span class="comment-like-btn" th:data-comment-idx="${comment.commentIdx}">‚ù§Ô∏è</span>
                                    <span class="comment-like-count" th:text="${comment.commentLike}"></span>
                                </span>
                                <span>üëÄ <span th:text="${comment.commentView}"></span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="post" th:if="${boardList.isEmpty()}">
            <div class="board-isEmpty">
                <span>ÏïÑÏßÅ Îì±Î°ùÎêú Í≤åÏãúÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§.</span>
            </div>
        </div>
        <div class="post-create" th:if="${boardList.isEmpty()}">
            <div>
                <form th:action="@{/board}" method="post" th:object="${board}" enctype="multipart/form-data">
                    <div style="display: flex; align-items: center;">
                        <img class="profile-img" th:src="@{${'/profile-images/' + member.userImage}}" alt="ÌîÑÎ°úÌïÑ">
                        <div class="user-info">
                            <span class="user-name" th:text="${member.userName}"></span>
                            <span class="user-id" th:text="${'@' +member.userId}"></span>
                        </div>
                    </div>
                    <div>
                        <input type="text" th:field="*{boardContent}" placeholder="Ï≤´ Í≤åÏãúÎ¨ºÏùÑ ÏûëÏÑ±ÌïòÏã§ÎûòÏöî?">
                    </div>

                    <!-- Ïù¥ÎØ∏ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ Ïä¨ÎùºÏù¥Îìú -->
                    <div class="image-slider">
                        <button type="button" class="slide-btn left">&#10094;</button>
                        <div class="preview-container" id="preview-container"></div>
                        <button type="button" class="slide-btn right">&#10095;</button>
                    </div>

                    <div class="buttons">
                        <input type="file" class="upload-btn" name="files" onchange="preView(this);" multiple
                               accept="image/*"/>
                        <button class="file-btn" onclick="ImgUpload(event)">Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉù</button>
                        <button class="submit-btn">ÏûëÏÑ± ÏôÑÎ£å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ÏûêÏã†Ïù¥ ÎåìÍ∏ÄÏùÑ ÏûëÏÑ±Ìïú Î™©Î°ù    -->
    <div class="tab-content" id="comments">
        <!-- Í≤åÏãúÎ¨º Í∏∞Ï§Ä Î∞òÎ≥µ -->
        <div class="post" th:each="entry : ${userCommentMap}">
            <div th:with="board=${entry.key}, commentList=${entry.value}">

                <!-- Í≤åÏãúÎ¨º Ìó§Îçî -->
                <div class="post-header">
                    <a th:href="@{${'/profile/' + commentboardWriter[commentList[0].commentIdx].idx}}">
                        <img class="profile-img"
                             th:src="@{${'/profile-images/' + commentboardWriter[commentList[0].commentIdx].userImage}}"
                             alt="ÌîÑÎ°úÌïÑ">
                    </a>
                    <div class="user-info">
                        <span class="user-name"
                              th:text="${commentboardWriter[commentList[0].commentIdx].userName}"></span>
                        <span class="user-id"
                              th:text="${'@' + commentboardWriter[commentList[0].commentIdx].userId}"></span>
                    </div>
                    <span class="time" th:data-time="${board.boardAt}"></span>
                </div>

                <!-- Í≤åÏãúÎ¨º ÎÇ¥Ïö© -->
                <div class="comment-main" style="border-left: 5px solid #dddd; margin-left: 22px; padding-left: 35px;">
                    <div class="board-line-info">
                        <a class="boardDetail" th:href="@{'/board/' + ${board.boardIdx}}">
                            <div class="post-content" th:text="${board.boardContent}"></div>

                            <!-- Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ -->
                            <div class="board-img-list comment-img-list">
                                <div class="board-img-list-inner comment-img-list-inner">
                                    <button class="board-slide-left">&#10094;</button>
                                    <div class="comment-img-list-inner-container">
                                        <div class="img-list-inner"
                                             th:each="imgUrl : ${commentboardImages[commentList[0].commentIdx]}">
                                            <img th:src="@{${'/board-images/' + imgUrl}}" alt="Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ">
                                        </div>
                                    </div>
                                    <button class="board-slide-right">&#10095;</button>
                                </div>
                            </div>
                        </a>


                        <!-- Í≤åÏãúÎ¨º Ïï°ÏÖò -->
                        <div class="profile-actions-comments">
                            <span class="toggle-comments">üí¨ <span th:text="${board.boardComent}"></span></span>
                            <span>
                                <span class="boardLike-btn" th:data-board-idx="${board.boardIdx}">‚ù§Ô∏è</span>
                                <span class="board-like-count" th:text="${board.boardLike}"></span>
                            </span>
                            <span>üëÄ <span th:text="${board.boardView}"></span></span>
                        </div>
                    </div>
                </div>

                <!-- ÎåìÍ∏Ä Î¶¨Ïä§Ìä∏ Î∞òÎ≥µ -->
                <div class="comment-all" th:each="userComment : ${commentList}">
                    <!-- ÎåìÍ∏Ä Ìó§Îçî -->
                    <div class="post-header">
                        <a th:href="@{${'/profile/' + member.idx}}">
                            <img class="profile-img" th:src="@{${'/profile-images/' + member.userImage}}" alt="ÌîÑÎ°úÌïÑ">
                        </a>
                        <div class="user-info">
                            <span class="user-name" th:text="${member.userName}"></span>
                            <span class="user-id" th:text="${'@' + member.userId}"></span>
                        </div>
                        <span class="time" th:data-time="${userComment.commentAt}"></span>
                    </div>

                    <!-- ÎåìÍ∏Ä ÎÇ¥Ïö© -->
                    <div class="comment-main">
                        <div class="post-content" th:text="${userComment.commentContent}"></div>
                        <div class="board-img-list comment-img-list">
                            <div class="board-img-list-inner comment-img-list-inner">
                                <button class="board-slide-left">&#10094;</button>
                                <div class="comment-img-list-inner-container">
                                    <div class="img-list-inner"
                                         th:each="imgUrl : ${usercommentImages[userComment.commentIdx]}">
                                        <img th:src="@{${'/comment-images/' + imgUrl}}" alt="Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ">
                                    </div>
                                </div>
                                <button class="board-slide-right">&#10095;</button>
                            </div>
                        </div>

                        <div class="profile-actions">
                            <span class="toggle-comments">üí¨ <span th:text="${userComment.commentRelay}"></span></span>
                            <span class="">
                                <span class="comment-like-btn" th:data-comment-idx="${userComment.commentIdx}">‚ù§Ô∏è</span>
                                <span class="comment-like-count" th:text="${userComment.commentLike}"></span>
                            </span>
                            <span>üëÄ <span th:text="${userComment.commentView}"></span></span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>


    <!-- Ï¢ãÏïÑÏöî ÎàÑÎ•∏ Î™©Î°ù -->
    <div class="tab-content" id="likes">
        <div class="post" th:each="like : ${userLike}">
            <!-- Í≤åÏãúÎ¨º ÏûëÏÑ±Ïûê Ï†ïÎ≥¥ -->
            <div class="post-header">
                <a th:href="@{${'/profile/' + likeboardWriter[like.likeIdx].idx}}">
                    <img class="profile-img" th:src="@{${'/profile-images/' + likeboardWriter[like.likeIdx].userImage}}"
                         alt="ÌîÑÎ°úÌïÑ">
                </a>
                <div class="user-info">
                    <span class="user-name" th:text="${likeboardWriter[like.likeIdx].userName}"></span>
                    <span class="user-id" th:text="${'@' + likeboardWriter[like.likeIdx].userId}"></span>
                </div>
                <span class="time" th:data-time="${userboardLike[like.likeBoardidx].boardAt}"></span>
            </div>

            <!-- Í≤åÏãúÎ¨º ÎÇ¥Ïö© Î∞è ÎßÅÌÅ¨ -->
            <a class="boardDetail" th:href="@{${'/board/' + like.likeBoardidx}}">
                <div class="post-content" th:text="${userboardLike[like.likeBoardidx].boardContent}"></div>

                <!-- Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ Î¶¨Ïä§Ìä∏ -->
                <div class="board-img-list">
                    <div class="board-img-list-inner">
                        <button class="board-slide-left">&#10094;</button>
                        <div class="img-list-inner board-list" th:each="img : ${likeboardImages[like.likeBoardidx]}">
                            <img th:src="@{${'/board-images/' + img}}" alt="Ï¢ãÏïÑÏöî Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ"/>
                        </div>
                        <button class="board-slide-right">&#10095;</button>
                    </div>
                </div>
            </a>

            <!-- Í≤åÏãúÎ¨º Ïï°ÏÖò Ï†ïÎ≥¥ -->
            <div class="profile-actions">
                <span class="toggle-comments">üí¨ <span th:text="${userboardLike[like.likeBoardidx].boardComent}"></span></span>
                <span>
                <span class="boardLike-btn" th:data-board-idx="${like.likeBoardidx}">‚ù§Ô∏è</span>
                <span class="board-like-count" th:text="${userboardLike[like.likeBoardidx].boardLike}"></span>
            </span>
                <span>üëÄ <span th:text="${userboardLike[like.likeBoardidx].boardView}"></span></span>
            </div>

            <!-- ÎåìÍ∏Ä Î≤ÑÌäº ÌÅ¥Î¶≠  -->
            <div class="comment-section" style="border:0 "
                 th:attr="data-board-id=${userboardLike[like.likeBoardidx].boardComent}">
                <!--  ÎåìÍ∏Ä Î™©Î°ù Í∞ÄÏ†∏Ïò§Í∏∞   -->
                <div th:each="comment : ${likeboardComment[like.likeBoardidx]}" class="comment-bar">
                    <div>
                        <div class="post-header">
                            <a th:href="@{${'/profile/' + likeboardCommentMember[comment.commentIdx].idx}}">
                                <img class="profile-img"
                                     th:src="@{${'/profile-images/' + likeboardCommentMember[comment.commentIdx].userImage}}"
                                     alt="ÌîÑÎ°úÌïÑ">
                            </a>
                            <div class="user-info">
                                <span class="user-name"
                                      th:text="${likeboardCommentMember[comment.commentIdx].userName}"></span>
                                <span class="user-id"
                                      th:text="${'@' +likeboardCommentMember[comment.commentIdx].userId}"></span>
                            </div>
                        </div>
                        <div class="comment-main">
                            <div class="post-content comment-content" th:text="${comment.commentContent}">
                            </div>
                            <div class="board-img-list comment-img-list">
                                <div class="board-img-list-inner comment-img-list-inner">
                                    <button class="board-slide-left">&#10094;</button>
                                    <div class="comment-img-list-inner-container">
                                        <div class="img-list-inner"
                                             th:each="imgUrl : ${likeboardCommentImages.get(comment.commentIdx)}">
                                            <img th:src="@{${'/comment-images/' + imgUrl}}" alt="Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ">
                                        </div>
                                    </div>
                                    <button class="board-slide-right">&#10095;</button>
                                </div>
                            </div>
                            <div class="profile-actions">
                                <span class="toggle-comments">üí¨ <span th:text="${comment.commentRelay}"></span></span>
                                <span>
                                    <span class="comment-like-btn" th:data-comment-idx="${comment.commentIdx}">‚ù§Ô∏è</span>
                                    <span class="comment-like-count" th:text="${comment.commentLike}"></span>
                                </span>
                                <span>üëÄ <span th:text="${comment.commentView}"></span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</th:block>
</body>
</html>
<script th:inline="javascript">

    // Î°úÍ∑∏Ïù∏ÌïòÏßÄ ÏïäÏïòÏùÑ Í≤ΩÏö∞ Î©îÏÑ∏ÏßÄ ÎàÑÎ•¥Î©¥ Î™ª ÎÑòÏñ¥Í∞ÄÍ≤å
    function message(event) {
        event.preventDefault(); // Í∏∞Î≥∏ Ïù¥Îèô ÎßâÍ∏∞

        const isLoggedIn = /*[[${#authorization.expression('isAuthenticated()')}]]*/ false;

        if (!isLoggedIn) {
            alert("Î°úÍ∑∏Ïù∏ Ìï¥Ï£ºÏÑ∏Ïöî");
            window.location.href = "/login"; // Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
        } else {
            const idx = event.currentTarget.getAttribute("data-idx");
            window.location.href = `/message/${idx}`; // member.idx Ìè¨Ìï®Ìï¥ÏÑú Ïù¥Îèô
        }
    }

    // Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îìú Ïù¥ÎèôÌïòÎäî ÌÉúÍ∑∏ ÎßâÍ∏∞
    document.querySelectorAll('.board-slide-left, .board-slide-right')
        .forEach(btn => {
            btn.addEventListener('click', function (event) {
                event.preventDefault();      // a ÌÉúÍ∑∏ Ïù¥Îèô ÎßâÍ∏∞
                event.stopPropagation();    // Î∂ÄÎ™® ÏöîÏÜåÎ°ú Ïù¥Î≤§Ìä∏ Ï†ÑÌååÎèÑ ÎßâÍ∏∞

                // Ïä¨ÎùºÏù¥Îìú Î°úÏßÅ Ïã§Ìñâ
                console.log("Ïä¨ÎùºÏù¥Îìú Î≤ÑÌäº ÌÅ¥Î¶≠!");
            });
        });

    // ÎåìÍ∏Ä Ï∞Ω Ïó¥Í∏∞ ÌÜ†Í∏Ä
    document.addEventListener("DOMContentLoaded", function () {
        const commentToggles = document.querySelectorAll(".toggle-comments");

        const isLoggedIn = /*[[${#authorization.expression('isAuthenticated()')}]]*/ false;

        commentToggles.forEach(toggle => {
            toggle.addEventListener("click", function () {
                if (!isLoggedIn) {
                    alert("Î°úÍ∑∏Ïù∏ Ìï¥Ï£ºÏÑ∏Ïöî");
                    window.location.href = "/login";  // Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
                    return;
                }
                const commentSection = this.closest(".post").querySelector(".comment-section");
                if (commentSection.style.display === "none" || commentSection.style.display === "") {
                    commentSection.style.display = "block";
                } else {
                    commentSection.style.display = "none";
                }
            });
        });
    });

    // ÌòÑÏû¨ ÏãúÍ∞ÑÏóêÏÑú - Í≤åÏã§Î¨º Ïò¨Î¶∞ ÏãúÍ∞Ñ ÎÇòÌÉÄÎÇ¥Í∏∞
    document.addEventListener("DOMContentLoaded", function () {
        const timeElements = document.querySelectorAll(".time");

        timeElements.forEach(element => {
            const boardTime = new Date(element.getAttribute("data-time")); // Í≤åÏãúÎ¨º ÏãúÍ∞Ñ
            const now = new Date(); // ÌòÑÏû¨ ÏãúÍ∞Ñ

            const diff = Math.floor((now - boardTime) / 1000); // Ï¥à Îã®ÏúÑ Ï∞®Ïù¥

            let timeAgo;
            if (diff < 60) {
                timeAgo = "Î∞©Í∏à Ï†Ñ";
            } else if (diff < 3600) {
                timeAgo = Math.floor(diff / 60) + "Î∂Ñ Ï†Ñ";
            } else if (diff < 86400) {
                timeAgo = Math.floor(diff / 3600) + "ÏãúÍ∞Ñ Ï†Ñ";
            } else if (diff < 604800) {
                timeAgo = Math.floor(diff / 86400) + "Ïùº Ï†Ñ";
            } else {
                timeAgo = boardTime.toISOString().split("T")[0]; // 1Ï£º Ïù¥ÏÉÅÏù¥Î©¥ ÎÇ†Ïßú ÌëúÏãú
            }

            element.textContent = timeAgo;
        });
    });

    // Í≤åÏã§Î¨º Ïù¥ÎØ∏ÏßÄ Î≤ÑÌäº
    function ImgUpload(event) {
        event.preventDefault(); // Í∏∞Î≥∏ Ïù¥Î≤§Ìä∏(Ìèº Ï†úÏ∂ú) Î∞©ÏßÄ
        document.querySelector(".upload-btn").click();
    }

    // ÎåìÍ∏Ä Ïù¥ÎØ∏ÏßÄ Î≤ÑÌäº
    function CommentImgUpload(event) {
        event.preventDefault();

        const button = event.currentTarget; // Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉù Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠
        const boardId = button.dataset.boardId; // ÌÅ¥Î¶≠Ìïú Î≤ÑÌäºÏùò data Í∞íÏùÑ Í∞ÄÏ†∏Ïò¥

        // Îçî ÏïàÏ†ÑÌïòÍ≤å: Î≤ÑÌäº Í∏∞Ï§ÄÏúºÎ°ú Í∞ÄÏû• Í∞ÄÍπåÏö¥ comment-section Ï∞æÍ∏∞
        const commentSection = button.closest(".comment-section");// Î≤ÑÌäº Í∏∞Ï§ÄÏúºÎ°ú Í∞ÄÏû• Í∞ÄÍπåÏö¥ .comment-section Ï∞æÍ∏∞

        const fileInput = commentSection.querySelector(".commentupload-btn"); // Ìï¥Îãπ ÏÑπÏÖò ÏïàÏùò input[type="file"] Ï∞æÍ∏∞

        fileInput.dataset.boardId = boardId; // fileInputÏóê data Í∞íÏùÑ Í∞ïÏ†úÎ°ú ÎÑ£Ïñ¥Ï§å
        fileInput.click(); // input ÌÅ¥Î¶≠Ìï¥ÏÑú ÌååÏùº ÏÑ†ÌÉùÏ∞Ω Ïó¥Í∏∞
    }

    // Í≤åÏãúÎ¨º preView Î∞è ÎåìÍ∏Ä preView
    let postImages = [];  // Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ Î∞∞Ïó¥
    let commentImagesMap = {};  // key: boardId, value: Ïù¥ÎØ∏ÏßÄ Î∞∞Ïó¥

    // Í≤åÏãúÎ¨º Î∞è ÎåìÍ∏Ä Ïù¥ÎØ∏ÏßÄ ÌîÑÎ¶¨Î∑∞
    function preView(input) {
        const isComment = input.classList.contains("commentupload-btn");
        const boardId = input.dataset.boardId;

        let previewContainer;
        if (isComment) {
            previewContainer = document.querySelector(`.comment-section[data-board-id="${boardId}"] .comment-container`);
            if (!commentImagesMap[boardId]) {
                commentImagesMap[boardId] = [];  // Ï¥àÍ∏∞Ìôî
            }
        } else {
            previewContainer = document.getElementById("preview-container");
        }

        let images = isComment ? commentImagesMap[boardId] : postImages;

        if (input.files.length + images.length > 10) {
            alert("ÏµúÎåÄ 10Ïû•ÍπåÏßÄÎßå ÏóÖÎ°úÎìúÌï† Ïàò ÏûàÏäµÎãàÎã§.");
            return;
        }

        Array.from(input.files).forEach((file) => {
            if (!file.type.startsWith("image/")) return;

            images.push(file);

            const reader = new FileReader();
            reader.onload = function (e) {
                const imgWrapper = document.createElement("div");
                imgWrapper.classList.add("preview-wrapper");

                const img = document.createElement("img");
                img.src = e.target.result;
                img.classList.add("preview-img");

                const closeBtn = document.createElement("span");
                closeBtn.classList.add("preview-close");
                closeBtn.textContent = "X";
                closeBtn.onclick = function () {
                    const currentIndex = images.indexOf(file);
                    removeImage(currentIndex, isComment, boardId); // ‚ú® boardId ÎÑòÍ∏∞Í∏∞
                };

                imgWrapper.appendChild(img);
                imgWrapper.appendChild(closeBtn);
                previewContainer.appendChild(imgWrapper);
                if (isComment) {
                    initComentSlider();
                } else {
                    initBoardSlider();
                }
            };
            reader.readAsDataURL(file);
        });

        updateFileInput(isComment, boardId); // ‚ú® boardId ÎÑòÍ∏∞Í∏∞
    }

    // Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ ÏÇ≠Ï†ú Î∞è ÎåìÍ∏Ä Ïù¥ÎØ∏ÏßÄ ÏÇ≠Ï†ú
    function removeImage(index, isComment, boardId = null) {
        let images = isComment ? commentImagesMap[boardId] : postImages;

        let previewContainer;
        if (isComment) {
            const commentSection = document.querySelector(`.comment-section[data-board-id="${boardId}"]`);
            previewContainer = commentSection.querySelector(".comment-container");
        } else {
            previewContainer = document.getElementById("preview-container");
        }

        images.splice(index, 1);

        const dataTransfer = new DataTransfer();
        images.forEach(file => dataTransfer.items.add(file));

        if (isComment) {
            const container = document.querySelector(`.comment-section[data-board-id="${boardId}"]`);
            const fileInput = container.querySelector(".commentupload-btn");
            fileInput.files = dataTransfer.files;
        } else {
            const fileInput = document.querySelector(".upload-btn");
            fileInput.files = dataTransfer.files;
        }

        // ÎØ∏Î¶¨Î≥¥Í∏∞ Îã§Ïãú Î†åÎçîÎßÅ
        previewContainer.innerHTML = '';
        images.forEach((file) => {
            const reader = new FileReader();
            reader.onload = function (e) {
                const imgWrapper = document.createElement("div");
                imgWrapper.classList.add("preview-wrapper");

                const img = document.createElement("img");
                img.src = e.target.result;
                img.classList.add("preview-img");

                const closeBtn = document.createElement("span");
                closeBtn.classList.add("preview-close");
                closeBtn.textContent = "X";
                closeBtn.onclick = function () {
                    const currentIndex = images.indexOf(file);
                    removeImage(currentIndex, isComment, boardId);
                };

                imgWrapper.appendChild(img);
                imgWrapper.appendChild(closeBtn);
                previewContainer.appendChild(imgWrapper);
            };
            reader.readAsDataURL(file);
        });
    }

    //ÏÑ†ÌÉùÌïú Ïù¥ÎØ∏ÏßÄÎ•º inputÏóê ÎÑ£Ïñ¥Ï§å Í∏∞Ï°¥ ÌååÏùºÏùÑ Ïú†ÏßÄÌï¥Ï§å
    function updateFileInput(isComment, boardId = null) {
        const dataTransfer = new DataTransfer();
        let images;

        if (isComment) {
            images = commentImagesMap[boardId] || [];
            const container = document.querySelector(`.comment-section[data-board-id="${boardId}"]`);
            const fileInput = container.querySelector(".commentupload-btn");
            images.forEach(file => dataTransfer.items.add(file));
            fileInput.files = dataTransfer.files;
        } else {
            images = postImages;
            const fileInput = document.querySelector(".upload-btn");
            images.forEach(file => dataTransfer.items.add(file));
            fileInput.files = dataTransfer.files;
        }
    }

    // Í≤åÏãúÎ¨º Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îìú
    document.addEventListener("DOMContentLoaded", function () {
        const sliders = document.querySelectorAll(".board-img-list-inner");

        sliders.forEach(slider => {
            const imgContainer = slider.querySelectorAll(".board-list");
            const images = Array.from(imgContainer);
            const leftBtn = slider.querySelector(".board-slide-left");
            const rightBtn = slider.querySelector(".board-slide-right");
            let currentIndex = 0;
            const imgWidth = 285; // Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞ (275px + Ïó¨Î∞± 25px Í≥†Î†§)
            const maxIndex = images.length - 2; // ‚úÖ ÏµúÎåÄ Ïù¥Îèô Í∞ÄÎä• Ïù∏Îç±Ïä§

            // Ïä¨ÎùºÏù¥Îìú Ïù¥Îèô Ìï®Ïàò
            function updateSlide() {
                const offset = -(currentIndex * imgWidth);
                imgContainer.forEach(img => img.style.transform = `translateX(${offset}px)`);

                // ÏôºÏ™Ω Î≤ÑÌäº Ï†úÏñ¥
                leftBtn.style.display = currentIndex > 0 ? 'block' : 'none';

                // Ïò§Î•∏Ï™Ω Î≤ÑÌäº Ï†úÏñ¥
                rightBtn.style.display = currentIndex >= maxIndex ? 'none' : 'block';
            }

            // ‚¨ÖÔ∏è ÏôºÏ™Ω Ïù¥Îèô
            leftBtn.addEventListener("click", function () {
                if (currentIndex > 0) {
                    currentIndex--;
                    updateSlide();
                }
            });

            // ‚û°Ô∏è Ïò§Î•∏Ï™Ω Ïù¥Îèô
            rightBtn.addEventListener("click", function () {
                if (currentIndex < maxIndex) {
                    currentIndex++;
                    updateSlide();
                }
            });

            // Ï¥àÍ∏∞ Ïä¨ÎùºÏù¥Îìú ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            updateSlide();
        });
    });

    function initBoardSlider() {
        const sliders = document.querySelector(".image-slider");
        const imgContainer = sliders.querySelector(".preview-container");
        const images = Array.from(imgContainer.querySelectorAll(".preview-wrapper"));
        const leftBtn = sliders.querySelector(".left");
        const rightBtn = sliders.querySelector(".right");
        const imgWidth = 285;
        let currentIndex = 0;

        const maxIndex = Math.max(images.length - 2, 0); // ‚úÖ Ìï≠ÏÉÅ 0 Ïù¥ÏÉÅÏúºÎ°ú

        function updateSlide() {
            const offset = -(currentIndex * imgWidth);
            imgContainer.style.transform = `translateX(${offset}px)`;

            leftBtn.style.display = currentIndex > 0 ? 'block' : 'none';
            rightBtn.style.display = currentIndex < maxIndex ? 'block' : 'none';
        }

        leftBtn.onclick = function () {
            if (currentIndex > 0) {
                currentIndex--;
                updateSlide();
            }
        };

        rightBtn.onclick = function () {
            if (currentIndex < maxIndex) {
                currentIndex++;
                updateSlide();
            }
        };

        updateSlide();
    }

    // ÎåìÍ∏Ä ÏûëÏÑ± Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îìú
    function initComentSlider() {
        const sliders = document.querySelectorAll(".comment-slider");

        sliders.forEach(slider => {
            const imgContainer = slider.querySelector(".comment-container");
            const images = Array.from(imgContainer.querySelectorAll(".preview-wrapper")); // ‚ùóÏä¨ÎùºÏù¥ÎìúÌï† Ïù¥ÎØ∏ÏßÄÎì§
            const leftBtn = slider.querySelector(".comment-left");
            const rightBtn = slider.querySelector(".comment-right");
            const imgWidth = 285;
            let currentIndex = 0;

            const maxIndex = Math.max(images.length - 2, 0); // ‚úÖ Ìï≠ÏÉÅ 0 Ïù¥ÏÉÅÏúºÎ°ú

            function updateSlide() {
                const offset = -(currentIndex * imgWidth);
                imgContainer.style.transform = `translateX(${offset}px)`;

                leftBtn.style.display = currentIndex > 0 ? 'block' : 'none';
                rightBtn.style.display = currentIndex < maxIndex ? 'block' : 'none';
            }

            leftBtn.onclick = function () {
                if (currentIndex > 0) {
                    currentIndex--;
                    updateSlide();
                }
            };

            rightBtn.onclick = function () {
                if (currentIndex < maxIndex) {
                    currentIndex++;
                    updateSlide();
                }
            };

            updateSlide();
        });
    }

    // ÎåìÍ∏Ä Î¶¨Ïä§Ìä∏ Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îìú
    document.addEventListener("DOMContentLoaded", function () {
        const sliders = document.querySelectorAll(".comment-img-list-inner");

        sliders.forEach(slider => {
            const imgContainer = slider.querySelector(".comment-img-list-inner-container");
            const images = slider.querySelectorAll(".img-list-inner");
            const leftBtn = slider.querySelector(".board-slide-left");
            const rightBtn = slider.querySelector(".board-slide-right");

            if (!imgContainer || images.length === 0) return;

            const imageWidth = 285; // Ïù¥ÎØ∏ÏßÄ 275 + ÎßàÏßÑ Ìè¨Ìï®
            const moveStep = 275;   // Ïä¨ÎùºÏù¥Îìú Ïù¥Îèô Ìè≠
            const viewWidth = 456;  // Î≥¥Ïó¨ÏßÄÎäî ÏòÅÏó≠ Ìè≠

            const totalWidth = images.length * imageWidth;
            const maxTranslateX = totalWidth - viewWidth;

            const translatePositions = [];
            let currentX = 0;

            while (currentX + viewWidth < totalWidth) {
                translatePositions.push(currentX);
                currentX += moveStep;
            }

            // ÎßàÏßÄÎßâ ÏúÑÏπò Ï∂îÍ∞Ä (ÎÅùÍπåÏßÄ Î≥¥Ïù¥Í≤å)
            if (translatePositions[translatePositions.length - 1] !== maxTranslateX) {
                translatePositions.push(maxTranslateX);
            }

            let currentIndex = 0;


            function updateSlide() {
                if (images.length > 1) {
                    const offset = -translatePositions[currentIndex];
                    imgContainer.style.transform = `translateX(${offset}px)`;
                } else {
                    imgContainer.style.transform = `translateX(0px)`;
                }
                leftBtn.style.display = currentIndex > 0 ? 'block' : 'none';
                rightBtn.style.display = currentIndex < translatePositions.length - 1 ? 'block' : 'none';
            }

            rightBtn.addEventListener("click", () => {
                if (currentIndex < translatePositions.length - 1) {
                    currentIndex++;
                    updateSlide();
                }
            });

            leftBtn.addEventListener("click", () => {
                if (currentIndex > 0) {
                    currentIndex--;
                    updateSlide();
                }
            });

            updateSlide();
        });
    });

    // Í≤åÏãúÎ¨º Ï∞úÌïòÍ∏∞ Í∏∞Îä•
    document.addEventListener("DOMContentLoaded", function () {
        const btns = document.querySelectorAll(".boardLike-btn");

        btns.forEach(btn => {
            const boardIdx = btn.dataset.boardIdx;
            const likeCountSpan = btn.parentElement.querySelector(".board-like-count");

            fetch(`/board/like-status/${boardIdx}`, {
                method: "GET",
                headers: {
                    "Content-Type": "application/json"
                }
            })
                .then(response => response.json())
                .then(data => {
                    if (data.status === "liked") {
                        btn.textContent = "‚ù§Ô∏è";
                        likeCountSpan.textContent = data.likeCount;
                    } else if (data.status === "not_liked") {
                        btn.textContent = "üñ§";
                        likeCountSpan.textContent = data.likeCount;
                    }
                })
                .catch(error => console.error("Error :", error));

            btn.addEventListener("click", function () {
                fetch(`/board/like/${boardIdx}`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    }
                })
                    .then(response => {
                        if (response.status === 401) {
                            alert("Î°úÍ∑∏Ïù∏ÏùÑ Ìï¥Ï£ºÏãúÍ∏∞ Î∞îÎûçÎãàÎã§");
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.status === "added") {
                            btn.textContent = "‚ù§Ô∏è";
                            likeCountSpan.textContent = Number(likeCountSpan.textContent) + 1;
                        } else if (data.status === "removed") {
                            btn.textContent = "üñ§";
                            likeCountSpan.textContent = Number(likeCountSpan.textContent) - 1;
                        }
                    })
                    .catch(error => console.error("Error :", error));
            });
        });
    });

    // ÎåìÍ∏Ä Ï∞úÌïòÍ∏∞ Í∏∞Îä•
    document.addEventListener("DOMContentLoaded", function () {
        const btns = document.querySelectorAll(".comment-like-btn");

        btns.forEach(btn => {
            const commentIdx = btn.dataset.commentIdx;
            const likeCountSpan = btn.parentElement.querySelector(".comment-like-count");

            fetch(`/comment_like/status/${commentIdx}`, {
                method: "GET",
                headers: {
                    "Content-Type": "application/json"
                }
            })
                .then(response => response.json())
                .then(data => {
                    if (data.status === "liked") {
                        btn.textContent = "‚ù§Ô∏è";
                        likeCountSpan.textContent = data.likeCount;
                    } else if (data.status === "not_liked") {
                        btn.textContent = "üñ§";
                        likeCountSpan.textContent = data.likeCount;
                    }
                })
                .catch(error => console.error("Error :", error));

            btn.addEventListener("click", function () {
                fetch(`/comment_like/${commentIdx}`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    }
                })
                    .then(response => {
                        if (response.status === 401) {
                            alert("Î°úÍ∑∏Ïù∏ÏùÑ Ìï¥Ï£ºÏãúÍ∏∞ Î∞îÎûçÎãàÎã§");
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.status === "added") {
                            btn.textContent = "‚ù§Ô∏è";
                            likeCountSpan.textContent = Number(likeCountSpan.textContent) + 1;
                        } else if (data.status === "removed") {
                            btn.textContent = "üñ§";
                            likeCountSpan.textContent = Number(likeCountSpan.textContent) - 1;
                        }
                    })
                    .catch(error => console.error("Error :", error));
            });
        });
    });

    // section Í∞í Î≥ÄÍ≤Ω
    document.querySelectorAll(".tab-btn").forEach(button => {
        button.addEventListener("click", () => {
            document.querySelectorAll(".tab-btn").forEach(btn => btn.classList.remove("active"));
            document.querySelectorAll(".tab-content").forEach(content => content.style.display = "none");

            button.classList.add("active");
            const target = button.getAttribute("data-tab");
            document.getElementById(target).style.display = "block";
        });
    });

    // Í≤åÏãúÍ∏Ä ÏÇ≠Ï†ú ÌÜ†Í∏Ä
    function toggleDeleteForm(btn) {
        const post = btn.closest('.post');
        const deleteForm = post.querySelector('.delete-form');
        deleteForm.classList.toggle('show');
    }

    // ÌåîÎ°úÏö∞ÌïòÍ∏∞ Í∏∞Îä• API
    document.addEventListener("DOMContentLoaded", function () {
        const btn = document.querySelector(".follow-btn");
        const memberIdx = btn.dataset.memberIdx;
        const followingCountSpan = document.querySelector(".follower-count");


        fetch(`/profile/follow/${memberIdx}`, {
            method: "GET",
            headers: {
                "Content-Type": "application/json"
            }
        })
            .then(response => response.json())
            .then(data => {
                if (data.status === "following") {
                    btn.textContent = "ÌåîÎ°úÏûâ";
                    btn.classList.add("active");
                    followingCountSpan.textContent = data.followCount;
                } else if (data.status === "mutual") {
                    btn.textContent = "ÎßûÌåîÎ°úÏö∞ ÌïòÍ∏∞";
                    btn.classList.remove("active");
                    followingCountSpan.textContent = data.followCount;
                } else if (data.status === "not_following") {
                    btn.textContent = "ÌåîÎ°úÏö∞ ÌïòÍ∏∞";
                    btn.classList.remove("active");
                    followingCountSpan.textContent = data.followCount;
                }
            })
            .catch(error => console.error("Error:", error));

        btn.addEventListener("click", function () {
            const isFollowing = btn.classList.contains("active");

            // Ïñ∏ÌåîÎ°úÏö∞ÌïòÎ†§Îäî Í≤ΩÏö∞
            if (isFollowing) {
                const confirmUnfollow = confirm("ÌåîÎ°úÏûâÏùÑ Ï∑®ÏÜåÌïòÏãúÍ≤†ÏäµÎãàÍπå?");
                if (!confirmUnfollow) {
                    return; // ÏÇ¨Ïö©ÏûêÍ∞Ä Ï∑®ÏÜå ÎàÑÎ•¥Î©¥ ÏïÑÎ¨¥ ÎèôÏûëÎèÑ ÌïòÏßÄ ÏïäÏùå
                }
            }

            fetch(`/profile/following/${memberIdx}`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                }
            })
                .then(response => {
                    if (response.status === 401) {
                        alert("Î°úÍ∑∏Ïù∏ÏùÑ Ìï¥Ï£ºÏãúÍ∏∞ Î∞îÎûçÎãàÎã§");
                        window.location.href = "/login";
                        return;
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.status === "added") {
                        btn.textContent = "ÌåîÎ°úÏûâ";
                        btn.classList.add("active");
                        followingCountSpan.textContent = Number(followingCountSpan.textContent) + 1;
                    } else if (data.status === "removed") {
                        btn.textContent = "ÌåîÎ°úÏö∞ ÌïòÍ∏∞";
                        btn.classList.remove("active");
                        followingCountSpan.textContent = Number(followingCountSpan.textContent) - 1;
                    }
                })
                .catch(error => console.error("Error:", error));
        });
    });

    // ÌåùÏóÖ Ïó¥Í∏∞
    document.querySelector(".edit-btn").addEventListener("click", function () {
        document.getElementById("editProfileModal").style.display = "block";
    });

    // ÌåùÏóÖ Îã´Í∏∞
    document.querySelector(".close").addEventListener("click", function () {
        document.getElementById("editProfileModal").style.display = "none";
    });

    // Ïù¥ÎØ∏ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞
    document.getElementById("profileImageInput").addEventListener("change", function (event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                document.getElementById("previewImage").src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    });

    // Ïù¥Î¶Ñ Î∞è Ïù¥ÎØ∏ÏßÄ Î≥ÄÍ≤Ω
    function SaveBtn() {
        const userName = document.getElementById("userName").value;
        const introduce = document.getElementById("introduce").value;
        const file = document.getElementById("profileImageInput").files[0];

        const formData = new FormData();
        if (file) {
            formData.append("file", file);
        }
        formData.append("userName", userName);
        formData.append("introduce", introduce);

        fetch("/profile/update", {
            method: "POST",
            body: formData
        })
            .then(response => response.json())
            .then(data => {
                if (data.status === "success") {
                    alert(data.message);
                    location.reload();
                } else {
                    alert("ÌîÑÎ°úÌïÑ ÏàòÏ†ï Ïã§Ìå®: " + data.message);
                }
            })
            .catch(error => console.error("Error:", error));
    }

</script>